<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Macpcap: Protocols/parser.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Macpcap<span id="projectnumber">&#160;1.1.0.0</span>
   </div>
   <div id="projectbrief">MAC Pcap Analysis Tool</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5ea33db0a1993c4d5092919185aa74b2.html">Protocols</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">parser.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="parser_8h_source.html">parser.h</a>&quot;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &quot;<a class="el" href="_host_pair_8h_source.html">HostPair.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for parser.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp__incl.png" border="0" usemap="#a_protocols_2parser_8cpp" alt=""/></div>
<map name="a_protocols_2parser_8cpp" id="a_protocols_2parser_8cpp">
<area shape="rect" title=" " alt="" coords="568,5,709,31"/>
<area shape="rect" href="parser_8h.html" title=" " alt="" coords="1009,79,1077,104"/>
<area shape="rect" title=" " alt="" coords="1565,299,1611,324"/>
<area shape="rect" href="_host_pair_8h.html" title=" " alt="" coords="375,225,457,251"/>
<area shape="rect" title=" " alt="" coords="5,372,77,397"/>
<area shape="rect" title=" " alt="" coords="1300,299,1391,324"/>
<area shape="rect" title=" " alt="" coords="1415,299,1489,324"/>
<area shape="rect" title=" " alt="" coords="1183,299,1276,324"/>
<area shape="rect" title=" " alt="" coords="269,299,382,324"/>
<area shape="rect" title=" " alt="" coords="129,299,193,324"/>
<area shape="rect" title=" " alt="" coords="1697,299,1781,324"/>
<area shape="rect" href="_t_c_p_conversation_8h.html" title="TCP Conversation Class." alt="" coords="974,152,1111,177"/>
<area shape="rect" href="_ethernet_stats_8h.html" title="Ethernet Class Header File." alt="" coords="533,225,646,251"/>
<area shape="rect" href="_protocol_stats_8h.html" title=" " alt="" coords="1288,225,1400,251"/>
<area shape="rect" title=" " alt="" coords="671,225,753,251"/>
<area shape="rect" title=" " alt="" coords="1937,372,1996,397"/>
<area shape="rect" title=" " alt="" coords="778,225,862,251"/>
<area shape="rect" href="tabulate_8hpp.html" title=" " alt="" coords="762,299,913,324"/>
<area shape="rect" title=" " alt="" coords="886,225,991,251"/>
<area shape="rect" title=" " alt="" coords="1015,225,1070,251"/>
<area shape="rect" title=" " alt="" coords="1094,225,1162,251"/>
<area shape="rect" title=" " alt="" coords="193,372,247,397"/>
<area shape="rect" title=" " alt="" coords="1039,299,1107,324"/>
<area shape="rect" href="csvfile_8h.html" title=" " alt="" coords="508,299,636,324"/>
<area shape="rect" title=" " alt="" coords="1693,372,1758,397"/>
<area shape="rect" title=" " alt="" coords="1783,372,1836,397"/>
<area shape="rect" title=" " alt="" coords="366,372,413,397"/>
<area shape="rect" title=" " alt="" coords="1860,372,1913,397"/>
<area shape="rect" title=" " alt="" coords="437,372,502,397"/>
<area shape="rect" title=" " alt="" coords="527,372,601,397"/>
<area shape="rect" title=" " alt="" coords="626,372,689,397"/>
<area shape="rect" title=" " alt="" coords="713,372,783,397"/>
<area shape="rect" title=" " alt="" coords="807,372,865,397"/>
<area shape="rect" title=" " alt="" coords="889,372,951,397"/>
<area shape="rect" title=" " alt="" coords="975,372,1038,397"/>
<area shape="rect" title=" " alt="" coords="1063,372,1119,397"/>
<area shape="rect" title=" " alt="" coords="1143,372,1203,397"/>
<area shape="rect" title=" " alt="" coords="1228,372,1295,397"/>
<area shape="rect" title=" " alt="" coords="1319,372,1388,397"/>
<area shape="rect" title=" " alt="" coords="1412,372,1473,397"/>
<area shape="rect" title=" " alt="" coords="272,372,341,397"/>
<area shape="rect" title=" " alt="" coords="1498,372,1577,397"/>
<area shape="rect" title=" " alt="" coords="1601,372,1668,397"/>
<area shape="rect" title=" " alt="" coords="101,372,168,397"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac26ef64041e9f903a2c5be97d84a55ac"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parser_8cpp.html#ac26ef64041e9f903a2c5be97d84a55ac">getIPMapInstance</a> (const pcpp::Packet &amp;pkt, std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;hostPairList, bool debug)</td></tr>
<tr class="separator:ac26ef64041e9f903a2c5be97d84a55ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6a4dd0688689794f429bf50d536aaf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parser_8cpp.html#aca6a4dd0688689794f429bf50d536aaf">processTcpPacket</a> (const pcpp::Packet &amp;pkt, pcpp::IPv4Layer *ipHdr, std::map&lt; std::string, <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> &gt; &amp;tcpl, std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;hostPairList, bool debug, int pc)</td></tr>
<tr class="separator:aca6a4dd0688689794f429bf50d536aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2c56bfa72939babf0bfdba59f66a8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parser_8cpp.html#a4f2c56bfa72939babf0bfdba59f66a8f">processIpPacket</a> (const pcpp::Packet &amp;pkt, pcpp::Layer *ipHdr, std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;hostPairList, std::map&lt; std::string, <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> &gt; &amp;tcpl, int pc, bool debug)</td></tr>
<tr class="separator:a4f2c56bfa72939babf0bfdba59f66a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92b56aac1954a5de1dbef18199907d6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parser_8cpp.html#a92b56aac1954a5de1dbef18199907d6f">processEthernet</a> (pcpp::Packet &amp;pkt, std::map&lt; std::string, <a class="el" href="class_ethernet_stats.html">EthernetStats</a> &gt; &amp;ethernetStatsList, bool debug)</td></tr>
<tr class="separator:a92b56aac1954a5de1dbef18199907d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b8deb1ef31c22f5191f01fc491158e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parser_8cpp.html#ac7b8deb1ef31c22f5191f01fc491158e">getMacAddress</a> (pcpp::Packet &amp;pkt, bool debug)</td></tr>
<tr class="separator:ac7b8deb1ef31c22f5191f01fc491158e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a260fcaf9e4fff6fc401343db4f4637ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parser_8cpp.html#a260fcaf9e4fff6fc401343db4f4637ff">processProtocol</a> (const pcpp::Packet &amp;pkt, pcpp::ProtocolType p, std::map&lt; std::string, <a class="el" href="class_protocol_stats.html">ProtocolStats</a> &gt; &amp;pl, bool debug)</td></tr>
<tr class="separator:a260fcaf9e4fff6fc401343db4f4637ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ee70ee0c8333de3e4585b6e57330227"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parser_8cpp.html#a7ee70ee0c8333de3e4585b6e57330227">parser</a> (pcpp::Packet &amp;pkt, std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;hostPairList, std::map&lt; std::string, <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> &gt; &amp;tcpConversationList, std::map&lt; std::string, <a class="el" href="class_ethernet_stats.html">EthernetStats</a> &gt; &amp;ethernetStatsList, std::map&lt; std::string, <a class="el" href="class_protocol_stats.html">ProtocolStats</a> &gt; &amp;pl, int pc, bool debug)</td></tr>
<tr class="separator:a7ee70ee0c8333de3e4585b6e57330227"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The parser function is used to take a packet and read its header to see which packet handler to send it too </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>is a pcpp::Packet type and is the packet to be processed</td></tr>
  </table>
  </dd>
</dl>
<p>Layer is the base class for all protocol layers. Each protocol supported in PcapPlusPlus has a class that inherits Layer. The protocol layer class expose all properties and methods relevant for viewing and editing protocol fields. For example: a pointer to a structured header (e.g tcphdr, iphdr, etc.), protocol header size, payload size, compute fields that can be automatically computed, print protocol data to string, etc. Each protocol instance is obviously part of a protocol stack (which construct a packet). This protocol stack is represented in PcapPlusPlus in a linked list, and each layer is an element in this list. That's why each layer has proprties to the next and previous layer in the protocol stack The Layer class, as a base class, is abstract and the user can't create an instance of it (it has a private constructor) Each layer holds a pointer to the relevant place in the packet. The layer sees all the data from this pointer forward until the end of the packet.</p>
<p>Here is an example packet showing this concept:</p>
<p>Packet will typically consist of the following headers:</p>
<p>|--&mdash;| </p><pre class="fragment">  |--------------------------------------------------|
  EthLayer data

             |---------------------------------------|
             IPv4Layer data

                         |---------------------------|
                         TcpLayer data

                                    |----------------|
                                    PayloadLayer data
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ac26ef64041e9f903a2c5be97d84a55ac" name="ac26ef64041e9f903a2c5be97d84a55ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac26ef64041e9f903a2c5be97d84a55ac">&#9670;&#160;</a></span>getIPMapInstance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string getIPMapInstance </td>
          <td>(</td>
          <td class="paramtype">const pcpp::Packet &amp;&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hostPairList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine is used to process the IP header and construct a <a class="el" href="class_host_pair.html">HostPair</a> instance if it is the first packet. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>- pcpp parsed packet </td></tr>
    <tr><td class="paramname">hostPairList</td><td>- map of <a class="el" href="class_host_pair.html">HostPair</a> instances </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>key - key is a string of a source and destination IP pair: 1.1.1.1-2.2.2.2<ul>
<li><p class="startli">Returns a string key which is the IP host pair addresses in the format SRCIP&lt;--&gt;DSTIP</p>
<p class="startli"><p>Flowchart: <a href="getIPMapInstance.svg">getIPMapInstance</a></p> </p>
</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="autotoc_md21"></a>
Process Overview</h2>
<h3><a class="anchor" id="autotoc_md22"></a>
Get IP Pair Key and Return to Caller</h3>
<ul>
<li>Call ipPairKey to get a vector that has two keys:<ul>
<li>Source and destination key as seen in the first packet</li>
<li>Reverse key of the above.</li>
<li>Example: 192.168.1.1-192.168.2.1 192.168.2.1-192.168.1.1</li>
</ul>
</li>
<li>Using the keys search the map <a class="el" href="class_host_pair.html">HostPair</a> for a match. Return matching key.<ul>
<li>Exception: Create a <a class="el" href="class_host_pair.html">HostPair</a> instance using the first key</li>
</ul>
</li>
</ul>
<h4><a class="anchor" id="autotoc_md23"></a>
allocate instance of hostPair if key is not in Master.hostpair, otherwise select appropriate key.</h4>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_cgraph.png" border="0" usemap="#aparser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_cgraph" alt=""/></div>
<map name="aparser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_cgraph" id="aparser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,133,56"/>
<area shape="rect" href="class_host_pair.html#a9423514b1bcdca2895abbeb6161d9d94" title="Get IP Pair Key This routine will create a ip source and destination key used to index the hostPairLi..." alt="" coords="201,5,335,31"/>
<area shape="rect" href="class_host_pair.html#a284f4b0d2fdb7cad3bbea3f4d147c827" title=" " alt="" coords="181,55,355,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_icgraph.png" border="0" usemap="#aparser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_icgraph" alt=""/></div>
<map name="aparser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_icgraph" id="aparser_8cpp_ac26ef64041e9f903a2c5be97d84a55ac_icgraph">
<area shape="rect" title=" " alt="" coords="556,5,684,31"/>
<area shape="rect" href="parser_8cpp.html#a4f2c56bfa72939babf0bfdba59f66a8f" title=" " alt="" coords="211,5,331,31"/>
<area shape="rect" href="parser_8cpp.html#aca6a4dd0688689794f429bf50d536aaf" title=" " alt="" coords="379,31,508,56"/>
<area shape="rect" href="parser_8cpp.html#a7ee70ee0c8333de3e4585b6e57330227" title=" " alt="" coords="104,5,163,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="ac7b8deb1ef31c22f5191f01fc491158e" name="ac7b8deb1ef31c22f5191f01fc491158e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7b8deb1ef31c22f5191f01fc491158e">&#9670;&#160;</a></span>getMacAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; getMacAddress </td>
          <td>(</td>
          <td class="paramtype">pcpp::Packet &amp;&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Routine to get mac addresses of a packet</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>Parsed Packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_ac7b8deb1ef31c22f5191f01fc491158e_icgraph.png" border="0" usemap="#aparser_8cpp_ac7b8deb1ef31c22f5191f01fc491158e_icgraph" alt=""/></div>
<map name="aparser_8cpp_ac7b8deb1ef31c22f5191f01fc491158e_icgraph" id="aparser_8cpp_ac7b8deb1ef31c22f5191f01fc491158e_icgraph">
<area shape="rect" title=" " alt="" coords="556,5,669,31"/>
<area shape="rect" href="parser_8cpp.html#aca6a4dd0688689794f429bf50d536aaf" title=" " alt="" coords="379,5,508,31"/>
<area shape="rect" href="parser_8cpp.html#a4f2c56bfa72939babf0bfdba59f66a8f" title=" " alt="" coords="211,5,331,31"/>
<area shape="rect" href="parser_8cpp.html#a7ee70ee0c8333de3e4585b6e57330227" title=" " alt="" coords="104,5,163,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="a7ee70ee0c8333de3e4585b6e57330227" name="a7ee70ee0c8333de3e4585b6e57330227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ee70ee0c8333de3e4585b6e57330227">&#9670;&#160;</a></span>parser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parser </td>
          <td>(</td>
          <td class="paramtype">pcpp::Packet &amp;&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hostPairList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpConversationList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_ethernet_stats.html">EthernetStats</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ethernetStatsList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_protocol_stats.html">ProtocolStats</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parser is used to control the processing of pcapPlusPlus Parsed Packet</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>Parsed PCPP Packet </td></tr>
    <tr><td class="paramname">hostPairList</td><td>Map of <a class="el" href="class_host_pair.html">HostPair</a> instances </td></tr>
    <tr><td class="paramname">tcpConversationList</td><td>Map of <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> instances </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_cgraph.png" border="0" usemap="#aparser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_cgraph" alt=""/></div>
<map name="aparser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_cgraph" id="aparser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,64,131"/>
<area shape="rect" href="parser_8cpp.html#a92b56aac1954a5de1dbef18199907d6f" title=" " alt="" coords="113,31,231,56"/>
<area shape="rect" href="parser_8cpp.html#a4f2c56bfa72939babf0bfdba59f66a8f" title=" " alt="" coords="112,105,232,131"/>
<area shape="rect" href="parser_8cpp.html#a260fcaf9e4fff6fc401343db4f4637ff" title=" " alt="" coords="114,155,230,180"/>
<area shape="rect" href="class_ethernet_stats.html#a79c66f827a92d913701601cccd58d382" title=" " alt="" coords="288,5,431,31"/>
<area shape="rect" href="class_host_pair.html#ad33e3cd7456204cc98f6564fbdd30657" title=" " alt="" coords="280,55,439,80"/>
<area shape="rect" href="parser_8cpp.html#ac26ef64041e9f903a2c5be97d84a55ac" title=" " alt="" coords="547,156,675,181"/>
<area shape="rect" href="class_host_pair.html#a9423514b1bcdca2895abbeb6161d9d94" title="Get IP Pair Key This routine will create a ip source and destination key used to index the hostPairLi..." alt="" coords="804,107,937,132"/>
<area shape="rect" href="parser_8cpp.html#aca6a4dd0688689794f429bf50d536aaf" title=" " alt="" coords="295,231,424,256"/>
<area shape="rect" href="class_host_pair.html#a284f4b0d2fdb7cad3bbea3f4d147c827" title=" " alt="" coords="784,156,957,181"/>
<area shape="rect" href="parser_8cpp.html#ac7b8deb1ef31c22f5191f01fc491158e" title=" " alt="" coords="555,205,668,231"/>
<area shape="rect" href="class_t_c_p_conversation.html#af4d10662d4933a3b5e092d6b34cf6462" title="Get TCP Conversation Key Routine to create a key for TCP Conversation Stats Table ( tcpConversationLi..." alt="" coords="487,255,736,280"/>
<area shape="rect" href="class_t_c_p_conversation.html#ae47427ba0e2816b6db2c86de5bfca5bf" title=" " alt="" coords="498,304,725,329"/>
<area shape="rect" href="class_t_c_p_conversation.html#a4bab6fc3c6af032e48f6b3ea1228c5cc" title=" " alt="" coords="502,353,721,379"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_icgraph.png" border="0" usemap="#aparser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_icgraph" alt=""/></div>
<map name="aparser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_icgraph" id="aparser_8cpp_a7ee70ee0c8333de3e4585b6e57330227_icgraph">
<area shape="rect" title=" " alt="" coords="104,5,163,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="a92b56aac1954a5de1dbef18199907d6f" name="a92b56aac1954a5de1dbef18199907d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92b56aac1954a5de1dbef18199907d6f">&#9670;&#160;</a></span>processEthernet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processEthernet </td>
          <td>(</td>
          <td class="paramtype">pcpp::Packet &amp;&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_ethernet_stats.html">EthernetStats</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ethernetStatsList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>Process an Ethernet header and set up an ethernetStats instance </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_a92b56aac1954a5de1dbef18199907d6f_cgraph.png" border="0" usemap="#aparser_8cpp_a92b56aac1954a5de1dbef18199907d6f_cgraph" alt=""/></div>
<map name="aparser_8cpp_a92b56aac1954a5de1dbef18199907d6f_cgraph" id="aparser_8cpp_a92b56aac1954a5de1dbef18199907d6f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,123,31"/>
<area shape="rect" href="class_ethernet_stats.html#a79c66f827a92d913701601cccd58d382" title=" " alt="" coords="171,5,313,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_a92b56aac1954a5de1dbef18199907d6f_icgraph.png" border="0" usemap="#aparser_8cpp_a92b56aac1954a5de1dbef18199907d6f_icgraph" alt=""/></div>
<map name="aparser_8cpp_a92b56aac1954a5de1dbef18199907d6f_icgraph" id="aparser_8cpp_a92b56aac1954a5de1dbef18199907d6f_icgraph">
<area shape="rect" title=" " alt="" coords="211,5,328,31"/>
<area shape="rect" href="parser_8cpp.html#a7ee70ee0c8333de3e4585b6e57330227" title=" " alt="" coords="104,5,163,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="a4f2c56bfa72939babf0bfdba59f66a8f" name="a4f2c56bfa72939babf0bfdba59f66a8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2c56bfa72939babf0bfdba59f66a8f">&#9670;&#160;</a></span>processIpPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processIpPacket </td>
          <td>(</td>
          <td class="paramtype">const pcpp::Packet &amp;&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pcpp::Layer *&#160;</td>
          <td class="paramname"><em>ipHdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hostPairList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to update counters for an IP packet. It will also call processTCPPacket to check for and handle the TCP header.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">master</td><td>Master Class </td></tr>
    <tr><td class="paramname">pkt</td><td>Parsed PCPP Packet </td></tr>
    <tr><td class="paramname">ipHdr</td><td>PCPP Layer for the IP Header </td></tr>
    <tr><td class="paramname">hostPairList</td><td>Map of <a class="el" href="class_host_pair.html">HostPair</a> instances </td></tr>
    <tr><td class="paramname">tcpl</td><td>Map of <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> instances </td></tr>
  </table>
  </dd>
</dl>
<h2><a class="anchor" id="autotoc_md28"></a>
Process Overview</h2>
<h3><a class="anchor" id="autotoc_md29"></a>
Check to see if this is a TCP packet, if so go process it</h3>
<h3><a class="anchor" id="autotoc_md30"></a>
Process counters for the IP packet and update HostPair instance</h3>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_cgraph.png" border="0" usemap="#aparser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_cgraph" alt=""/></div>
<map name="aparser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_cgraph" id="aparser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,125,107"/>
<area shape="rect" href="class_host_pair.html#ad33e3cd7456204cc98f6564fbdd30657" title=" " alt="" coords="173,5,332,31"/>
<area shape="rect" href="parser_8cpp.html#ac26ef64041e9f903a2c5be97d84a55ac" title=" " alt="" coords="441,107,569,132"/>
<area shape="rect" href="class_host_pair.html#a9423514b1bcdca2895abbeb6161d9d94" title="Get IP Pair Key This routine will create a ip source and destination key used to index the hostPairLi..." alt="" coords="697,57,831,83"/>
<area shape="rect" href="parser_8cpp.html#aca6a4dd0688689794f429bf50d536aaf" title=" " alt="" coords="188,181,317,207"/>
<area shape="rect" href="class_host_pair.html#a284f4b0d2fdb7cad3bbea3f4d147c827" title=" " alt="" coords="677,107,851,132"/>
<area shape="rect" href="parser_8cpp.html#ac7b8deb1ef31c22f5191f01fc491158e" title=" " alt="" coords="448,156,561,181"/>
<area shape="rect" href="class_t_c_p_conversation.html#af4d10662d4933a3b5e092d6b34cf6462" title="Get TCP Conversation Key Routine to create a key for TCP Conversation Stats Table ( tcpConversationLi..." alt="" coords="380,205,629,231"/>
<area shape="rect" href="class_t_c_p_conversation.html#ae47427ba0e2816b6db2c86de5bfca5bf" title=" " alt="" coords="391,255,618,280"/>
<area shape="rect" href="class_t_c_p_conversation.html#a4bab6fc3c6af032e48f6b3ea1228c5cc" title=" " alt="" coords="395,304,614,329"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_icgraph.png" border="0" usemap="#aparser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_icgraph" alt=""/></div>
<map name="aparser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_icgraph" id="aparser_8cpp_a4f2c56bfa72939babf0bfdba59f66a8f_icgraph">
<area shape="rect" title=" " alt="" coords="211,5,331,31"/>
<area shape="rect" href="parser_8cpp.html#a7ee70ee0c8333de3e4585b6e57330227" title=" " alt="" coords="104,5,163,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="a260fcaf9e4fff6fc401343db4f4637ff" name="a260fcaf9e4fff6fc401343db4f4637ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a260fcaf9e4fff6fc401343db4f4637ff">&#9670;&#160;</a></span>processProtocol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processProtocol </td>
          <td>(</td>
          <td class="paramtype">const pcpp::Packet &amp;&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pcpp::ProtocolType&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_protocol_stats.html">ProtocolStats</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Routine to get mac addresses of a packet</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>Parsed Packet </td></tr>
    <tr><td class="paramname">p</td><td>protocol type of first layer of packet </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_a260fcaf9e4fff6fc401343db4f4637ff_icgraph.png" border="0" usemap="#aparser_8cpp_a260fcaf9e4fff6fc401343db4f4637ff_icgraph" alt=""/></div>
<map name="aparser_8cpp_a260fcaf9e4fff6fc401343db4f4637ff_icgraph" id="aparser_8cpp_a260fcaf9e4fff6fc401343db4f4637ff_icgraph">
<area shape="rect" title=" " alt="" coords="211,5,327,31"/>
<area shape="rect" href="parser_8cpp.html#a7ee70ee0c8333de3e4585b6e57330227" title=" " alt="" coords="104,5,163,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="aca6a4dd0688689794f429bf50d536aaf" name="aca6a4dd0688689794f429bf50d536aaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca6a4dd0688689794f429bf50d536aaf">&#9670;&#160;</a></span>processTcpPacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int processTcpPacket </td>
          <td>(</td>
          <td class="paramtype">const pcpp::Packet &amp;&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pcpp::IPv4Layer *&#160;</td>
          <td class="paramname"><em>ipHdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_t_c_p_conversation.html">TCPConversation</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>tcpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; std::string, <a class="el" href="class_host_pair.html">HostPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hostPairList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>debug</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ProcessTcpPacket is where most of the work is done for analyzing the TCP header. Note: in order for the SYN flag too be used for the setting of first speaker this routine must be called before the processIpPacket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>- This is a parsed pcap plus plus (pcpp) packet </td></tr>
    <tr><td class="paramname">ipHdr</td><td>- This is the pcpp IP header </td></tr>
    <tr><td class="paramname">tcpl</td><td>- This is the map that maintains stats data for the TCP conversations </td></tr>
    <tr><td class="paramname">hostPairList</td><td>- This is the hostPair table (map) </td></tr>
  </table>
  </dd>
</dl>
<h2><a class="anchor" id="autotoc_md24"></a>
Process Overview</h2>
<h3><a class="anchor" id="autotoc_md25"></a>
Get TCP Layer and Header</h3>
<ul>
<li>Return 1 to caller if this packet does not have a TCP Header</li>
</ul>
<h3><a class="anchor" id="autotoc_md26"></a>
Construct a TCPConversation instance if this is the first packet. Set key to the conversation pair.</h3>
<ul>
<li>Call Master::getTcpConversation(pkt) to get vector of TCP Conversation keys<ul>
<li>Example:</li>
</ul>
<ol type="1">
<li>192.168.1.1-192.168.2.1.5000.6000</li>
<li>192.168.2.1-192.168.1.1.6000.5000</li>
</ol>
</li>
<li>Search map TCP Conversations using the key vector.<ul>
<li>Set firstSpeaker to the first packet or if the SYN bit is set. <b>Note: hostPair first speaker will also be set here</b></li>
<li>Construct an IP <a class="el" href="class_host_pair.html">HostPair</a> entry in the HostPairList map and set the first speaker. This will make sure the firstSpeaker in each class instance is the same IP pair</li>
</ul>
</li>
<li>Construct TCP Conversation Map Instance</li>
</ul>
<p>set source and destination Mac Address</p>
<ul>
<li>firstSpeaker will be set based on the following:<ol type="1">
<li>SYN Packet - will use s1</li>
<li>SYN Ack - will use s2 (reverse key)</li>
<li>First data packet seen</li>
</ol>
</li>
<li>Add TCP Conversation instance to the TCP Conversation Map</li>
</ul>
<p>Check for retransmissions</p>
<h3><a class="anchor" id="autotoc_md27"></a>
USe key from previous step to update counters for the TCP Conversation</h3>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_aca6a4dd0688689794f429bf50d536aaf_cgraph.png" border="0" usemap="#aparser_8cpp_aca6a4dd0688689794f429bf50d536aaf_cgraph" alt=""/></div>
<map name="aparser_8cpp_aca6a4dd0688689794f429bf50d536aaf_cgraph" id="aparser_8cpp_aca6a4dd0688689794f429bf50d536aaf_cgraph">
<area shape="rect" title=" " alt="" coords="5,128,135,153"/>
<area shape="rect" href="parser_8cpp.html#ac26ef64041e9f903a2c5be97d84a55ac" title=" " alt="" coords="243,29,371,55"/>
<area shape="rect" href="parser_8cpp.html#ac7b8deb1ef31c22f5191f01fc491158e" title=" " alt="" coords="251,79,364,104"/>
<area shape="rect" href="class_t_c_p_conversation.html#af4d10662d4933a3b5e092d6b34cf6462" title="Get TCP Conversation Key Routine to create a key for TCP Conversation Stats Table ( tcpConversationLi..." alt="" coords="183,128,432,153"/>
<area shape="rect" href="class_t_c_p_conversation.html#ae47427ba0e2816b6db2c86de5bfca5bf" title=" " alt="" coords="194,177,421,203"/>
<area shape="rect" href="class_t_c_p_conversation.html#a4bab6fc3c6af032e48f6b3ea1228c5cc" title=" " alt="" coords="198,227,417,252"/>
<area shape="rect" href="class_host_pair.html#a9423514b1bcdca2895abbeb6161d9d94" title="Get IP Pair Key This routine will create a ip source and destination key used to index the hostPairLi..." alt="" coords="500,5,633,31"/>
<area shape="rect" href="class_host_pair.html#a284f4b0d2fdb7cad3bbea3f4d147c827" title=" " alt="" coords="480,55,653,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="parser_8cpp_aca6a4dd0688689794f429bf50d536aaf_icgraph.png" border="0" usemap="#aparser_8cpp_aca6a4dd0688689794f429bf50d536aaf_icgraph" alt=""/></div>
<map name="aparser_8cpp_aca6a4dd0688689794f429bf50d536aaf_icgraph" id="aparser_8cpp_aca6a4dd0688689794f429bf50d536aaf_icgraph">
<area shape="rect" title=" " alt="" coords="379,5,508,31"/>
<area shape="rect" href="parser_8cpp.html#a4f2c56bfa72939babf0bfdba59f66a8f" title=" " alt="" coords="211,5,331,31"/>
<area shape="rect" href="parser_8cpp.html#a7ee70ee0c8333de3e4585b6e57330227" title=" " alt="" coords="104,5,163,31"/>
<area shape="rect" href="main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627" title=" " alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Apr 23 2023 11:17:33 for Macpcap by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
